(edit: see bottom of document for clear steps to follow!)

Ideas for assigment:
--------------------
* Using only OpenSSL tools
	+ easy
	- how..?
* Going down into details, use stuff from HA4
	+ probable, they want us to connect and re-use concepts
	- time-consuming..
* Brute force:ing
	+ will probably work, eventually
	- will take heckin long time...

https://tools.ietf.org/html/rfc3447#appendix-A.1.2
https://stackoverflow.com/questions/20457680/decrypt-rsa-message-with-part-of-private-key-censored
https://stackoverflow.com/questions/5747013/how-to-factor-rsa-modulus-given-the-public-and-private-exponent
https://crypto.stackexchange.com/questions/6361/is-sharing-the-modulus-for-multiple-rsa-key-pairs-secure/14713
https://wiki.openssl.org/index.php/Manual:ASN1_generate_nconf(3)


    0:d=0  hl=4 l= 605 cons: SEQUENCE          
    4:d=1  hl=2 l=   1 prim: INTEGER           :00
    7:d=1  hl=3 l= 129 prim: INTEGER           :C695C7A7B28ADE75C7A7B28ADE75C7A7B28ADE75C7A7B28ADE7754D4C619E39026E8C3165CECF2292351363E8E9A22008177DFBA8B435421F626F2F47A92A8AA2F3F24F28E0B628064ABFF49C7BA6057626A86BE2EC2F95A4105338BD738A8F297A7E406A14BBD7F5CE9F0E448329789985EEE036D030BDDEE6DAD3BA9D0BAB7
  139:d=1  hl=2 l=   3 prim: INTEGER           :010001
  144:d=1  hl=3 l= 129 prim: INTEGER           :8A2F0EE6271A28904BA2B6ECBE0463C7BFE6C6EA0307654CE5655AC7F3F9A8B70CB36214F49B6D3D56C7D1B8E1BD3A5FA3B6E7C483D6CB99FE0FC80A79A7C717B9B9ADDAE7E8A20C8C0662604370D7EAE6032AFDDFB5FD4245FC16F80359EE1F689483A8114CF1296E0DBE458C2ABB259E9C56EA7C73205EA6C754698E5E3EE1
  276:d=1  hl=2 l=  65 prim: INTEGER           :F2B0A12A3B39CD599D8FD1A4E77A6CAF2E02B6EC51737F4DAC7B8BA9AB7D22ED0C039D5282FE1CFBC760A3BE435409D3E4FA0B0611C924055A7BEAD4302E247F
  343:d=1  hl=2 l=  65 prim: INTEGER           :D17B8DC2B327652E3E62FA2696D67328ABC9B8CC226D9E0B14795356D894D613F80E3DA0E152120E70A2CC200B21FD8033E4D99C29AB7AAE77D1C3ED19F46DC9
  410:d=1  hl=2 l=  65 prim: INTEGER           :C783076B4577366726CDD5E64059F7C1680CD93E9B935CA38959A3AE5F89A74DC2E3B1D0E4596D905B0F0A6DDEC1D6B678F64A5BBA01667874338D10D56F0997
  477:d=1  hl=2 l=  64 prim: INTEGER           :664F79C505CACFD7EE10592C4FAF1D3F57E785A1ED8EAC09AD4E342DCE49A2E4CDD9E6AF945C8905146DEE54181BD9BBAB9CB1CB5B6EACD45920D21812FD1641
  543:d=1  hl=2 l=  64 prim: INTEGER           :059C4FBB42F4425B8FAFDCEB0890DEB77FE1888C77C2BAFF0BD7946904B95F5D74323A69AEF187A44EEE6F6C51ED48088BCAE5B5C82792B0D98A6245FA130F7D

RSAPrivateKey ::= SEQUENCE {
          version           Version,
          modulus           INTEGER,  -- n
          publicExponent    INTEGER,  -- e
          privateExponent   INTEGER,  -- d
          prime1            INTEGER,  -- p
          prime2            INTEGER,  -- q
          exponent1         INTEGER,  -- d mod (p-1)
          exponent2         INTEGER,  -- d mod (q-1)
          coefficient       INTEGER,  -- (inverse of q) mod p
          otherPrimeInfos   OtherPrimeInfos OPTIONAL
      }

RSAPrivateKey ::= SEQUENCE {
          version           00,
          modulus           n: C69754D4C619E39026E8C3165C014FFF4D56A8B5C34FC616FC9C5572FF41BDC8A22F4E61B1ECF2292351363E8E9A22008177DFBA8B435421F626F2F47A92A8AA2F3F24F28E0B628064ABFF49C7BA6057626A86BE2EC2F95A4105338BD738A8F297A7E406A14BBD7F5CE9F0E448329789985EEE036D030BDDEE6DAD3BA9D0BAB7 
          publicExponent    e: 010001
          privateExponent   d: 8A2F0EE6271A28904BA2B6ECBE0463C7BFE6C6EA0307654CE5655AC7F3F9A8B70CB36214F49B6D3D56C7D1B8E1BD3A5FA3B6E7C483D6CB99FE0FC80A79A7C717B9B9ADDAE7E8A20C8C0662604370D7EAE6032AFDDFB5FD4245FC16F80359EE1F689483A8114CF1296E0DBE458C2ABB259E9C56EA7C73205EA6C754698E5E3EE1
          prime1            p: F2B0A12A3B39CD599D8FD1A4E77A6CAF2E02B6EC51737F4DAC7B8BA9AB7D22ED0C039D5282FE1CFBC760A3BE435409D3E4FA0B0611C924055A7BEAD4302E247F
          prime2            q: D17B8DC2B327652E3E62FA2696D67328ABC9B8CC226D9E0B14795356D894D613F80E3DA0E152120E70A2CC200B21FD8033E4D99C29AB7AAE77D1C3ED19F46DC9
          exponent1         d mod (p-1): C783076B4577366726CDD5E64059F7C1680CD93E9B935CA38959A3AE5F89A74DC2E3B1D0E4596D905B0F0A6DDEC1D6B678F64A5BBA01667874338D10D56F0997
          exponent2         d mod (q-1): 664F79C505CACFD7EE10592C4FAF1D3F57E785A1ED8EAC09AD4E342DCE49A2E4CDD9E6AF945C8905146DEE54181BD9BBAB9CB1CB5B6EACD45920D21812FD1641
          coefficient       (inverse of q) mod p: 059C4FBB42F4425B8FAFDCEB0890DEB77FE1888C77C2BAFF0BD7946904B95F5D74323A69AEF187A44EEE6F6C51ED48088BCAE5B5C82792B0D98A6245FA130F7D
      }

head key.pem -n -1 | tail -n +2 | wc
	13	13	825

---

Multiplying p with q gives n. This turned out to be:
	n(hex): 0xC69754D4C619E39026E8C3165C014FFF4D56A8B5C34FC616FC9C5572FF41BDC8A22F4E61B1ECF2292351363E8E9A22008177DFBA8B435421F626F2F47A92A8AA2F3F24F28E0B628064ABFF49C7BA6057626A86BE2EC2F95A4105338BD738A8F297A7E406A14BBD7F5CE9F0E448329789985EEE036D030BDDEE6DAD3BA9D0BAB7


The beginning and end of this string corresponds to the n string retrieved from the censored PEM file, this should verify that the value is correct.  
(edit: checked it w/ python script, bytes 3-53(smth) differs)
Now for using that value:

    0:d=0  hl=4 l= 605 cons: SEQUENCE          
    4:d=1  hl=2 l=   1 prim: INTEGER           :00
    7:d=1  hl=3 l= 129 prim: INTEGER           :C69754D4C619E39026E8C3165C014FFF4D56A8B5C34FC616FC9C5572FF41BDC8A22F4E61B1ECF2292351363E8E9A22008177DFBA8B435421F626F2F47A92A8AA2F3F24F28E0B628064ABFF49C7BA6057626A86BE2EC2F95A4105338BD738A8F297A7E406A14BBD7F5CE9F0E448329789985EEE036D030BDDEE6DAD3BA9D0BAB7
  139:d=1  hl=2 l=   3 prim: INTEGER           :010001
  144:d=1  hl=3 l= 129 prim: INTEGER           :8A2F0EE6271A28904BA2B6ECBE0463C7BFE6C6EA0307654CE5655AC7F3F9A8B70CB36214F49B6D3D56C7D1B8E1BD3A5FA3B6E7C483D6CB99FE0FC80A79A7C717B9B9ADDAE7E8A20C8C0662604370D7EAE6032AFDDFB5FD4245FC16F80359EE1F689483A8114CF1296E0DBE458C2ABB259E9C56EA7C73205EA6C754698E5E3EE1
  276:d=1  hl=2 l=  65 prim: INTEGER           :F2B0A12A3B39CD599D8FD1A4E77A6CAF2E02B6EC51737F4DAC7B8BA9AB7D22ED0C039D5282FE1CFBC760A3BE435409D3E4FA0B0611C924055A7BEAD4302E247F
  343:d=1  hl=2 l=  65 prim: INTEGER           :D17B8DC2B327652E3E62FA2696D67328ABC9B8CC226D9E0B14795356D894D613F80E3DA0E152120E70A2CC200B21FD8033E4D99C29AB7AAE77D1C3ED19F46DC9
  410:d=1  hl=2 l=  65 prim: INTEGER           :C783076B4577366726CDD5E64059F7C1680CD93E9B935CA38959A3AE5F89A74DC2E3B1D0E4596D905B0F0A6DDEC1D6B678F64A5BBA01667874338D10D56F0997
  477:d=1  hl=2 l=  64 prim: INTEGER           :664F79C505CACFD7EE10592C4FAF1D3F57E785A1ED8EAC09AD4E342DCE49A2E4CDD9E6AF945C8905146DEE54181BD9BBAB9CB1CB5B6EACD45920D21812FD1641
  543:d=1  hl=2 l=  64 prim: INTEGER           :059C4FBB42F4425B8FAFDCEB0890DEB77FE1888C77C2BAFF0BD7946904B95F5D74323A69AEF187A44EEE6F6C51ED48088BCAE5B5C82792B0D98A6245FA130F7D

openssl asn1parse -genconf constructed_asn.txt -out new_key.der
openssl rsa -in new_key.der -inform DER -outform PEM
openssl rsa -in new_key.der -inform DER -outform PEM -out new_key.pem

openssl rsa -in new_key.pem -check -text

openssl base64 -d -in encrypted.txt > encrypted.bin
openssl pkeyutl -in encrypted.bin -inkey new_key.pem -keyform PEM -decrypt
This is secret

---

# So, steps:
* decode .pem file:
	openssl asn1parse -in key.pem [FILE]
* copy p and q into python file, which calculates n
* construct asn1 nconf file (atm manual labour)
* write in DER binary format w/ this:
	openssl asn1parse -genconf constructed_asn.txt -out new_key.der
* translate from DER to PEM:
	openssl rsa -in new_key.der -inform DER -outform PEM -out new_key.pem
* (optional: check key):
	openssl rsa -in new_key.pem -check -text
* transform base64-encoded encrypted value to binary:
	openssl base64 -d -in encrypted.txt > encrypted.bin
* decrypt this:
	openssl pkeyutl -in encrypted.bin -inkey new_key.pem -keyform PEM -decrypt

